#include "Mat.h"
#include<iostream>

char protein[] = {
    'C', 'S', 'T', 'P', 'A', 'G', 'N', 'D', 'E', 'Q',
    'H', 'R', 'K', 'M', 'I', 'L', 'V', 'F', 'Y', 'W',
};

Mat<int> ScoreMat(const int *score) {
    int i,j,k,p,q;
    Mat<int> s('Z','Z');
    for(i=k=0; i<20; i++) {
        p = protein[i];
        for(j=0; j<20; j++) {
            q = protein[j];
            if(j<i) s[p][q] = s[q][p];
            else s[p][q] = score[k++];
        }
    }
    return s;
}

Mat<int> PAM250() {// reference: D. W. Mount "Bioinformatics" figure 3.14
    int score[] = {
        12, 0, -2, -3, -2, -3, -4, -5, -5, -5, -3, -4, -5, -5, -2, -6, -2, -4, 0, -8,
            2, 1, 1, 1, 1, 1, 0, 0, -1, -1, 0, 0, -2, -1, -3, -1, -3, -3, -2,
               3, 0, 1, 0, 0, 0, 0, -1, -1, -1, 0, -1, 0, -2, 0, -3, -3, -5,
                  6, 1, -1, -1, -1, -1, 0, 0, 0, -1, -2, -2, -3, -1, -5, -5, -6,
                     2, 1, 0, 0, 0, 0, -1, -2, -1, -1, -1, -2, 0, -4, -3, -6,
                        5, 0, 1, 0, -1, -2, -3, -2, -3, -3, -4, -1, -5, -5, -7,
                           2, 2, 1, 1, 2, 0, 1, -2, -2, -3, -2, -4, -2, -4,
                              4, 3, 2, 1, -1, 0, -3, -2, -4, -2, -6, -4, -7,
                                 4, 2, 1, -1, 0, -2, -2, -3, -2, -5, -4, -7,
                                    4, 3, 1, 1, -1, -2, -2, -2, -5, -4, -5,
                                       6, 2, 0, -2, -2, -2, -2, -2, 0, -3,
                                          6, 3, 0, -2, -3, -2, -4, -4, 2,
                                             5, 0, -2, -3, -2, -5, -4, -3,
                                                6, 2, 4, 2, 0, -2, -4,
                                                   5, 2, 4, 1, -1, -5,
                                                      6, 2, 2, -1, -2,
                                                         4, -1, -2, -6,
                                                            9, 7, 0,
                                                               10, 0,
                                                                   17,
    };
    return ScoreMat(score);
}

Mat<int> eye(int diag=1) {// unit matrix * diag
    Mat<int> I(0,'Z','Z');
    for(int i=0; i<I.nrows(); i++) I[i][i] = diag;
    return I;
}